<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NoaChess</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ôû</text></svg>">
  <link rel="stylesheet" href="assets/chessground.css">
  <link rel="stylesheet" href="assets/chessground.cburnett.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: #fff;
      color: #333;
      transition: background 0.3s, color 0.3s;
    }

    body.dark {
      background: #1a1a1a;
      color: #e0e0e0;
    }

    header {
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid #8B4513;
    }

    h1 {
      font-size: 2.5rem;
      color: #8B4513;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      font-size: 1rem;
    }

    body.dark .subtitle {
      color: #aaa;
    }

    main {
      display: flex;
      max-width: 1200px;
      margin: 30px auto;
      padding: 20px;
      gap: 30px;
    }

    .board-wrapper {
      display: flex;
      flex-direction: row;
    }

    .captured-container {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      width: 40px;
      height: 600px;
      margin-right: 8px;
    }

    .captured-pieces {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 5px 0;
    }

    #capturedTop {
      justify-content: flex-start;
    }

    #capturedBottom {
      justify-content: flex-end;
    }

    .captured-piece {
      font-size: 20px;
      line-height: 1;
    }

    .captured-piece.white {
      color: #fff;
      text-shadow: 0 0 2px #000, 0 0 2px #000;
    }

    .captured-piece.black {
      color: #333;
    }

    body.dark .captured-piece.white {
      color: #eee;
      text-shadow: 0 0 2px #000;
    }

    body.dark .captured-piece.black {
      color: #888;
    }

    .board-container {
      flex: 0 0 600px;
    }

    #board {
      width: 600px;
      height: 600px;
    }

    .controls {
      flex: 1;
      min-width: 300px;
    }

    .section {
      background: #f5f5f5;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    body.dark .section {
      background: #2a2a2a;
      border-color: #444;
    }

    .section h2 {
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: #8B4513;
    }

    .btn {
      background: #8B4513;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .btn:hover {
      background: #6d3410;
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .input-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }

    input[type="number"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
    }

    body.dark input[type="number"] {
      background: #333;
      border-color: #555;
      color: #e0e0e0;
    }

    .checkbox-group {
      margin-bottom: 10px;
    }

    .checkbox-group label {
      display: inline;
      font-weight: normal;
      margin-left: 5px;
    }

    .variant-selector {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .variant-selector label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .variant-dropdown {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid #ddd;
      border-radius: 5px;
      background: white;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .variant-dropdown:hover {
      border-color: #8B4513;
    }

    .variant-dropdown:focus {
      outline: none;
      border-color: #8B4513;
      box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
    }

    body.dark .variant-dropdown {
      background: #333;
      border-color: #555;
      color: #e0e0e0;
    }

    body.dark .variant-dropdown:hover {
      border-color: #8B4513;
    }

    #status {
      padding: 10px;
      background: #e8f4f8;
      border-left: 4px solid #2196F3;
      margin-bottom: 15px;
      border-radius: 4px;
    }

    body.dark #status {
      background: #1a3a4a;
      border-color: #42a5f5;
    }

    #eval {
      font-size: 0.9rem;
      color: #666;
      margin-top: 5px;
    }

    body.dark #eval {
      color: #aaa;
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #8B4513;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 50px;
      cursor: pointer;
      font-size: 1.2rem;
    }

    @media (max-width: 1000px) {
      main {
        flex-direction: column;
        align-items: center;
      }

      .board-wrapper {
        flex: none;
      }

      .board-container {
        flex: none;
      }

      .controls {
        width: 100%;
        max-width: 600px;
      }
    }

    /* Brown board theme - NoaChess (6x6) */
    #board.variant-noachess .cg-wrap,
    #board:not(.variant-khasar) .cg-wrap {
      --files: 6;
      --ranks: 6;
    }

    #board.variant-noachess cg-board,
    #board:not(.variant-khasar) cg-board {
      background-image: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 6 6"><rect fill="%23f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="%23b58863" x="1" y="0" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="%23b58863" x="3" y="0" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="%23b58863" x="5" y="0" width="1" height="1"/><rect fill="%23b58863" x="0" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="%23b58863" x="2" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="%23b58863" x="4" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="%23b58863" x="1" y="2" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="%23b58863" x="3" y="2" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="%23b58863" x="5" y="2" width="1" height="1"/><rect fill="%23b58863" x="0" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="%23b58863" x="2" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="%23b58863" x="4" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="%23b58863" x="1" y="4" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="%23b58863" x="3" y="4" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="%23b58863" x="5" y="4" width="1" height="1"/><rect fill="%23b58863" x="0" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="%23b58863" x="2" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="%23b58863" x="4" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="5" width="1" height="1"/></svg>') !important;
      background-size: 100% 100% !important;
    }

    /* Khasar Chess (9x9) */
    #board.variant-khasar .cg-wrap {
      --files: 9;
      --ranks: 9;
    }

    #board.variant-khasar cg-board {
      background-image: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 9"><rect fill="%23f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="%23b58863" x="1" y="0" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="%23b58863" x="3" y="0" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="%23b58863" x="5" y="0" width="1" height="1"/><rect fill="%23f0d9b5" x="6" y="0" width="1" height="1"/><rect fill="%23b58863" x="7" y="0" width="1" height="1"/><rect fill="%23f0d9b5" x="8" y="0" width="1" height="1"/><rect fill="%23b58863" x="0" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="%23b58863" x="2" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="%23b58863" x="4" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="%23b58863" x="6" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="7" y="1" width="1" height="1"/><rect fill="%23b58863" x="8" y="1" width="1" height="1"/><rect fill="%23f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="%23b58863" x="1" y="2" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="%23b58863" x="3" y="2" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="%23b58863" x="5" y="2" width="1" height="1"/><rect fill="%23f0d9b5" x="6" y="2" width="1" height="1"/><rect fill="%23b58863" x="7" y="2" width="1" height="1"/><rect fill="%23f0d9b5" x="8" y="2" width="1" height="1"/><rect fill="%23b58863" x="0" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="%23b58863" x="2" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="%23b58863" x="4" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="%23b58863" x="6" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="7" y="3" width="1" height="1"/><rect fill="%23b58863" x="8" y="3" width="1" height="1"/><rect fill="%23f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="%23b58863" x="1" y="4" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="%23b58863" x="3" y="4" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="%23b58863" x="5" y="4" width="1" height="1"/><rect fill="%23f0d9b5" x="6" y="4" width="1" height="1"/><rect fill="%23b58863" x="7" y="4" width="1" height="1"/><rect fill="%23f0d9b5" x="8" y="4" width="1" height="1"/><rect fill="%23b58863" x="0" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="%23b58863" x="2" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="%23b58863" x="4" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="5" width="1" height="1"/><rect fill="%23b58863" x="6" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="7" y="5" width="1" height="1"/><rect fill="%23b58863" x="8" y="5" width="1" height="1"/><rect fill="%23f0d9b5" x="0" y="6" width="1" height="1"/><rect fill="%23b58863" x="1" y="6" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="6" width="1" height="1"/><rect fill="%23b58863" x="3" y="6" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="6" width="1" height="1"/><rect fill="%23b58863" x="5" y="6" width="1" height="1"/><rect fill="%23f0d9b5" x="6" y="6" width="1" height="1"/><rect fill="%23b58863" x="7" y="6" width="1" height="1"/><rect fill="%23f0d9b5" x="8" y="6" width="1" height="1"/><rect fill="%23b58863" x="0" y="7" width="1" height="1"/><rect fill="%23f0d9b5" x="1" y="7" width="1" height="1"/><rect fill="%23b58863" x="2" y="7" width="1" height="1"/><rect fill="%23f0d9b5" x="3" y="7" width="1" height="1"/><rect fill="%23b58863" x="4" y="7" width="1" height="1"/><rect fill="%23f0d9b5" x="5" y="7" width="1" height="1"/><rect fill="%23b58863" x="6" y="7" width="1" height="1"/><rect fill="%23f0d9b5" x="7" y="7" width="1" height="1"/><rect fill="%23b58863" x="8" y="7" width="1" height="1"/><rect fill="%23f0d9b5" x="0" y="8" width="1" height="1"/><rect fill="%23b58863" x="1" y="8" width="1" height="1"/><rect fill="%23f0d9b5" x="2" y="8" width="1" height="1"/><rect fill="%23b58863" x="3" y="8" width="1" height="1"/><rect fill="%23f0d9b5" x="4" y="8" width="1" height="1"/><rect fill="%23b58863" x="5" y="8" width="1" height="1"/><rect fill="%23f0d9b5" x="6" y="8" width="1" height="1"/><rect fill="%23b58863" x="7" y="8" width="1" height="1"/><rect fill="%23f0d9b5" x="8" y="8" width="1" height="1"/></svg>') !important;
      background-size: 100% 100% !important;
    }

    /* Piece sizing - ensure pieces fit squares properly */
    .cg-wrap piece {
      background-size: contain !important;
      background-repeat: no-repeat !important;
      background-position: center !important;
    }

    /* Khasar Chess pieces - Using much more specific selectors */
    /* Black Pawn - YELLOW colored (bP.svg) */
    #board.variant-khasar .cg-wrap piece.pawn.black,
    #board.variant-khasar .cg-wrap piece.p-piece.black,
    #board.variant-khasar .cg-wrap piece[class*="pawn"][class*="black"],
    #board.variant-khasar piece.p.black {
      background-image: url('/assets/khasar/bP.svg') !important;
    }

    /* White Pawn - uses default */

    /* King (Khan) */
    #board.variant-khasar .cg-wrap piece.king.white,
    #board.variant-khasar .cg-wrap piece.k-piece.white,
    #board.variant-khasar .cg-wrap piece[class*="king"][class*="white"],
    #board.variant-khasar piece.k.white {
      background-image: url('/assets/khasar/wK.svg') !important;
    }
    #board.variant-khasar .cg-wrap piece.king.black,
    #board.variant-khasar .cg-wrap piece.k-piece.black,
    #board.variant-khasar .cg-wrap piece[class*="king"][class*="black"],
    #board.variant-khasar piece.k.black {
      background-image: url('/assets/khasar/bK.svg') !important;
    }

    /* Lancer - Override Leaper */
    #board.variant-khasar .cg-wrap piece.lancer.white,
    #board.variant-khasar .cg-wrap piece.l-piece.white,
    #board.variant-khasar .cg-wrap piece.leaper.white,
    #board.variant-khasar .cg-wrap piece[class*="l"][class*="white"],
    #board.variant-khasar piece.l.white {
      background-image: url('/assets/khasar/wL.svg') !important;
    }
    #board.variant-khasar .cg-wrap piece.lancer.black,
    #board.variant-khasar .cg-wrap piece.l-piece.black,
    #board.variant-khasar .cg-wrap piece.leaper.black,
    #board.variant-khasar .cg-wrap piece[class*="l"][class*="black"],
    #board.variant-khasar piece.l.black {
      background-image: url('/assets/khasar/bL.svg') !important;
    }

    /* Kheshig */
    #board.variant-khasar .cg-wrap piece.kheshig.white,
    #board.variant-khasar .cg-wrap piece.h-piece.white,
    #board.variant-khasar .cg-wrap piece[class*="h"][class*="white"],
    #board.variant-khasar piece.h.white {
      background-image: url('/assets/khasar/wH.svg') !important;
    }
    #board.variant-khasar .cg-wrap piece.kheshig.black,
    #board.variant-khasar .cg-wrap piece.h-piece.black,
    #board.variant-khasar .cg-wrap piece[class*="h"][class*="black"],
    #board.variant-khasar piece.h.black {
      background-image: url('/assets/khasar/bH.svg') !important;
    }

    /* Archer */
    #board.variant-khasar .cg-wrap piece.archer.white,
    #board.variant-khasar .cg-wrap piece.a-piece.white,
    #board.variant-khasar .cg-wrap piece[class*="a"][class*="white"],
    #board.variant-khasar piece.a.white {
      background-image: url('/assets/khasar/wA.svg') !important;
    }
    #board.variant-khasar .cg-wrap piece.archer.black,
    #board.variant-khasar .cg-wrap piece.a-piece.black,
    #board.variant-khasar .cg-wrap piece[class*="a"][class*="black"],
    #board.variant-khasar piece.a.black {
      background-image: url('/assets/khasar/bA.svg') !important;
    }

    /* Yurt */
    #board.variant-khasar .cg-wrap piece.yurt.white,
    #board.variant-khasar .cg-wrap piece.y-piece.white,
    #board.variant-khasar .cg-wrap piece[class*="y"][class*="white"],
    #board.variant-khasar piece.y.white {
      background-image: url('/assets/khasar/wY.svg') !important;
    }
    #board.variant-khasar .cg-wrap piece.yurt.black,
    #board.variant-khasar .cg-wrap piece.y-piece.black,
    #board.variant-khasar .cg-wrap piece[class*="y"][class*="black"],
    #board.variant-khasar piece.y.black {
      background-image: url('/assets/khasar/bY.svg') !important;
    }

    /* Enhanced General piece (promoted pawn) */
    .cg-wrap piece.g.white,
    .cg-wrap piece.general.white {
      background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+CiAgPGcgZmlsbD0iI2ZmZiIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgIDwhLS0gSGVhZCB3aXRoIHNtYWxsIGNyb3duIC0tPgogICAgPGNpcmNsZSBjeD0iMjIuNSIgY3k9IjEzIiByPSI0Ii8+CiAgICA8cGF0aCBkPSJNMTkgMTBoN2wtMSAzaC01eiIgZmlsbD0iI2ZmZiIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIvPgogICAgPCEtLSBCb2R5IChlbmhhbmNlZCBwYXduIHN0eWxlKSAtLT4KICAgIDxwYXRoIGQ9Ik0xOSAxNmMwLTEuNSAxLjUtMi41IDMuNS0yLjVzMy41IDEgMy41IDIuNSIvPgogICAgPHBhdGggZD0iTTE3IDI1YzAgMCAyLTQgNS41LTRzNS41IDQgNS41IDQiLz4KICAgIDwhLS0gQmFzZSAtLT4KICAgIDxwYXRoIGQ9Ik0xMyAzNWMwIDAgMy01IDkuNS01czkuNSA1IDkuNSA1eiIvPgogICAgPHBhdGggZD0iTTEyIDM2aDIxIiBzdHJva2Utd2lkdGg9IjIiLz4KICA8L2c+Cjwvc3ZnPgo=') !important;
    }

    .cg-wrap piece.g.black,
    .cg-wrap piece.general.black {
      background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+CiAgPGcgZmlsbD0iIzAwMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgIDwhLS0gSGVhZCB3aXRoIHNtYWxsIGNyb3duIC0tPgogICAgPGNpcmNsZSBjeD0iMjIuNSIgY3k9IjEzIiByPSI0IiBmaWxsPSIjMDAwIi8+CiAgICA8cGF0aCBkPSJNMTkgMTBoN2wtMSAzaC01eiIgZmlsbD0iIzAwMCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIvPgogICAgPCEtLSBCb2R5IChlbmhhbmNlZCBwYXduIHN0eWxlKSAtLT4KICAgIDxwYXRoIGQ9Ik0xOSAxNmMwLTEuNSAxLjUtMi41IDMuNS0yLjVzMy41IDEgMy41IDIuNSIgZmlsbD0iIzAwMCIvPgogICAgPHBhdGggZD0iTTE3IDI1YzAgMCAyLTQgNS41LTRzNS41IDQgNS41IDQiIGZpbGw9IiMwMDAiLz4KICAgIDwhLS0gQmFzZSAtLT4KICAgIDxwYXRoIGQ9Ik0xMyAzNWMwIDAgMy01IDkuNS01czkuNSA1IDkuNSA1eiIgZmlsbD0iIzAwMCIvPgogICAgPHBhdGggZD0iTTEyIDM2aDIxIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iI2ZmZiIvPgogIDwvZz4KPC9zdmc+Cg==') !important;
    }

    /* Difficulty radio buttons */
    .difficulty-group {
      display: flex;
      gap: 15px;
      margin-bottom: 10px;
    }

    .difficulty-option {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      border: 2px solid #8B4513;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .difficulty-option:hover {
      background: #8B4513;
      color: white;
    }

    .difficulty-option input[type="radio"] {
      margin-right: 5px;
    }

    .difficulty-option:has(input:checked) {
      background: #8B4513;
      color: white;
    }

    body.dark .difficulty-option {
      border-color: #a0642f;
    }

    body.dark .difficulty-option:hover {
      background: #a0642f;
    }

    body.dark .difficulty-option:has(input:checked) {
      background: #a0642f;
    }

    /* Rules link */
    .rules-link {
      display: block;
      text-align: center;
      padding: 12px;
      background: #8B4513;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      font-weight: 500;
      transition: background 0.2s;
    }

    .rules-link:hover {
      background: #6d3410;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      overflow: auto;
    }

    .modal-content {
      background-color: #fff;
      margin: 3% auto;
      padding: 30px;
      border-radius: 10px;
      max-width: 800px;
      position: relative;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    body.dark .modal-content {
      background-color: #2a2a2a;
      color: #e0e0e0;
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 25px;
      font-size: 30px;
      font-weight: bold;
      color: #aaa;
      cursor: pointer;
    }

    .modal-close:hover {
      color: #000;
    }

    body.dark .modal-close:hover {
      color: #fff;
    }

    .modal-content h2 {
      margin-bottom: 20px;
      color: #8B4513;
    }

    body.dark .modal-content h2 {
      color: #a0642f;
    }

    .modal-content h3 {
      margin-top: 20px;
      margin-bottom: 10px;
      color: #8B4513;
    }

    body.dark .modal-content h3 {
      color: #a0642f;
    }

    .modal-content h4 {
      margin-top: 15px;
      margin-bottom: 8px;
      color: #333;
    }

    body.dark .modal-content h4 {
      color: #e0e0e0;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #ddd;
    }

    body.dark .tabs {
      border-color: #444;
    }

    .tab-button {
      padding: 10px 20px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      color: #666;
      border-bottom: 3px solid transparent;
      transition: all 0.2s;
    }

    .tab-button:hover {
      color: #8B4513;
    }

    .tab-button.active {
      color: #8B4513;
      border-bottom-color: #8B4513;
    }

    body.dark .tab-button {
      color: #aaa;
    }

    body.dark .tab-button:hover {
      color: #a0642f;
    }

    body.dark .tab-button.active {
      color: #a0642f;
      border-bottom-color: #a0642f;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .tab-content ul {
      margin-left: 20px;
      line-height: 1.8;
    }

    .tab-content p {
      line-height: 1.6;
      margin-bottom: 10px;
    }

    .piece-explanation {
      margin-bottom: 25px;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 8px;
      border-left: 4px solid #8B4513;
    }

    body.dark .piece-explanation {
      background: #333;
      border-color: #a0642f;
    }

    .piece-diagram {
      margin: 10px 0;
    }

    .mini-board {
      width: 150px;
      height: 150px;
      border: 2px solid #8B4513;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleDarkMode()">üåô</button>

  <header>
    <h1>NoaChess</h1>
    <p class="subtitle">A unique 6√ó6 chess variant</p>
  </header>

  <main>
    <div class="board-wrapper">
      <div class="captured-container">
        <div id="capturedTop" class="captured-pieces"></div>
        <div id="capturedBottom" class="captured-pieces"></div>
      </div>
      <div class="board-container">
        <div id="board"></div>
      </div>
    </div>

    <div class="controls">
      <div class="section">
        <h2>Chess Variant</h2>
        <div class="variant-selector">
          <label for="variantSelect">Select variant:</label>
          <select id="variantSelect" class="variant-dropdown">
            <option value="noachess" selected>NoaChess (6√ó6)</option>
            <option value="khasar">Khasar Chess (9√ó9)</option>
          </select>
        </div>
      </div>

      <div class="section">
        <h2>Game Status</h2>
        <div id="status">Ready to play!</div>
        <div id="eval"></div>
      </div>

      <div class="section">
        <h2>Controls</h2>
        <button class="btn" onclick="newGame()">New Game</button>
        <button class="btn" onclick="flipBoard()">Flip Board</button>
        <button class="btn" onclick="undoMove()">Undo</button>
      </div>

      <div class="section">
        <h2>Game Mode</h2>
        <div class="checkbox-group">
          <input type="checkbox" id="playWhite" checked>
          <label for="playWhite">Play as White</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="playBlack">
          <label for="playBlack">Play as Black</label>
        </div>
      </div>

      <div class="section">
        <h2>AI ÎÇúÏù¥ÎèÑ</h2>
        <div class="difficulty-group">
          <label class="difficulty-option">
            <input type="radio" name="difficulty" value="easy">
            <span>Ïâ¨ÏõÄ</span>
          </label>
          <label class="difficulty-option">
            <input type="radio" name="difficulty" value="hard" checked>
            <span>Ïñ¥Î†§ÏõÄ</span>
          </label>
        </div>
        <p style="font-size: 0.85rem; color: #666; margin-top: 10px;">
          Ïâ¨ÏõÄ: Í∏∞Î≥∏ AI | Ïñ¥Î†§ÏõÄ: Fairy-Stockfish
        </p>
      </div>

      <div class="section">
        <h2>AI ÏûêÍ∞Ä ÎåÄÍµ≠</h2>
        <div class="input-group">
          <label for="autoPlayCount">ÎåÄÍµ≠ Ïàò:</label>
          <input type="number" id="autoPlayCount" value="10" min="1" max="1000">
        </div>
        <button class="btn" id="startAutoPlay" onclick="startAutoPlay()">ÏãúÏûë</button>
        <button class="btn" id="stopAutoPlay" onclick="stopAutoPlay()" disabled>Ï§ëÏßÄ</button>
        <button class="btn" id="downloadGames" onclick="downloadGames()" disabled>Îã§Ïö¥Î°úÎìú</button>
        <div id="autoPlayStats" style="margin-top: 15px; font-size: 0.9rem;">
          <p>No games played yet.</p>
        </div>
      </div>

      <div class="section">
        <a href="#" class="rules-link" onclick="openRulesModal(); return false;">Í∑úÏπô ÏÑ§Î™Ö</a>
      </div>
    </div>
  </main>

  <!-- Rules Modal -->
  <div id="rulesModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeRulesModal()">&times;</span>
      <h2>NoaChess Í∑úÏπô</h2>

      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('basic')">Í∏∞Î≥∏ Í∑úÏπô</button>
        <button class="tab-button" onclick="switchTab('pieces')">Í∏∞Î¨º ÌñâÎßàÎ≤ï</button>
        <button class="tab-button" onclick="switchTab('special')">ÌäπÏàò Í∑úÏπô</button>
      </div>

      <div id="basic-tab" class="tab-content active">
        <h3>ÏäπÎ¶¨ Ï°∞Í±¥</h3>
        <p>ÏÉÅÎåÄÎ∞©Ïùò ÌÇπÏùÑ Ï≤¥ÌÅ¨Î©îÏù¥Ìä∏ÌïòÎ©¥ ÏäπÎ¶¨Ìï©ÎãàÎã§.</p>

        <h3>Í∏∞Î≥∏ Í∑úÏπô</h3>
        <ul>
          <li>6√ó6 Î≥¥ÎìúÏóêÏÑú ÏßÑÌñâÎê©ÎãàÎã§</li>
          <li>Î∞±Ïù¥ Î®ºÏ†Ä ÏãúÏûëÌï©ÎãàÎã§</li>
          <li>Ìè∞ÏùÄ ÎßàÏßÄÎßâ Îû≠ÌÅ¨Ïóê ÎèÑÎã¨ÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú Ïû•Íµ∞ÏúºÎ°ú ÏäπÍ∏âÎê©ÎãàÎã§
            <ul>
              <li>Î∞± Ìè∞: 6Îû≠ÌÅ¨ ÎèÑÎã¨ Ïãú ÏäπÍ∏â</li>
              <li>Ìùë Ìè∞: 1Îû≠ÌÅ¨ ÎèÑÎã¨ Ïãú ÏäπÍ∏â</li>
            </ul>
          </li>
          <li>Ïä§ÌÖåÏùºÎ©îÏù¥Ìä∏(ÍµêÏ∞© ÏÉÅÌÉú)Îäî Ìå®Î∞∞Î°ú Ï≤òÎ¶¨Îê©ÎãàÎã§</li>
        </ul>
      </div>

      <div id="pieces-tab" class="tab-content">
        <h3>Í∏∞Î¨ºÎ≥Ñ ÌñâÎßàÎ≤ï</h3>
        <p style="margin-bottom: 20px;"><strong>ÌëúÏãú Î∞©Î≤ï:</strong> <span style="color: blue;">‚óè</span> Ïù¥Îèô Í∞ÄÎä• | <span style="color: red;">‚óè</span> Í≥µÍ≤© Í∞ÄÎä• | <span style="color: purple;">‚óè</span> Ïù¥Îèô Î∞è Í≥µÍ≤© Í∞ÄÎä•</p>

        <div class="piece-explanation">
          <h4>‚ôü Ìè∞ (Pawn)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <circle cx="2.5" cy="1.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="1.5" cy="2.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="3.5" cy="2.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="1.5" cy="1.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="3.5" cy="1.5" r="0.15" fill="red" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <div class="piece-explanation">
          <h4>‚ôù ÎπÑÏàç (Bishop)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <circle cx="1.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="2.5" cy="0.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="0.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="4.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="2.5" cy="4.5" r="0.15" fill="purple" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <div class="piece-explanation">
          <h4>‚ôú Î£© (Rook)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <!-- Up 2 squares -->
              <circle cx="2.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="2.5" cy="0.5" r="0.15" fill="purple" opacity="0.7"/>
              <!-- Down 2 squares -->
              <circle cx="2.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="2.5" cy="4.5" r="0.15" fill="purple" opacity="0.7"/>
              <!-- Left 2 squares -->
              <circle cx="1.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="0.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <!-- Right 2 squares -->
              <circle cx="3.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="4.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
            </svg>
          </div>
          <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">* ÏµúÎåÄ 2Ïπ∏ÍπåÏßÄ Ïù¥Îèô/Í≥µÍ≤© Í∞ÄÎä•</p>
        </div>

        <div class="piece-explanation">
          <h4>‚ôõ ÌÄ∏ (Queen)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <!-- Knight moves (8) -->
              <circle cx="1.5" cy="0.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="0.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="0.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="4.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="0.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="4.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="4.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="4.5" r="0.15" fill="purple" opacity="0.7"/>
              <!-- Ferz moves (4 diagonals) -->
              <circle cx="1.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
            </svg>
          </div>
          <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">* ÎÇòÏù¥Ìä∏ Ïù¥Îèô(8Ïπ∏) + ÎåÄÍ∞ÅÏÑ† 1Ïπ∏(4Ïπ∏) = Ï¥ù 12Ïπ∏</p>
        </div>

        <div class="piece-explanation">
          <h4>‚ôû ÎÇòÏù¥Ìä∏ (Knight)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <circle cx="1.5" cy="0.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="0.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="0.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="4.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="0.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="4.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="4.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="4.5" r="0.15" fill="purple" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <div class="piece-explanation">
          <h4>‚öî Î¶¨Ìçº (Leaper)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <!-- Movement: Man (8 directions, 1 step) -->
              <circle cx="2.5" cy="1.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="1.5" cy="1.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="3.5" cy="1.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="1.5" cy="2.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="3.5" cy="2.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="2.5" cy="3.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="1.5" cy="3.5" r="0.15" fill="blue" opacity="0.7"/>
              <circle cx="3.5" cy="3.5" r="0.15" fill="blue" opacity="0.7"/>
              <!-- Capture: Alibaba (8 directions, 2 steps jump) -->
              <circle cx="2.5" cy="0.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="0.5" cy="0.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="4.5" cy="0.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="0.5" cy="2.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="4.5" cy="2.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="2.5" cy="4.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="0.5" cy="4.5" r="0.15" fill="red" opacity="0.7"/>
              <circle cx="4.5" cy="4.5" r="0.15" fill="red" opacity="0.7"/>
            </svg>
          </div>
          <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">* Ïù¥Îèô: 8Î∞©Ìñ• 1Ïπ∏ | Í≥µÍ≤©: 8Î∞©Ìñ• 2Ïπ∏ Ï†êÌîÑ</p>
        </div>

        <div class="piece-explanation">
          <h4>‚ôö ÌÇπ (King)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <circle cx="2.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="2.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
            </svg>
          </div>
        </div>

        <div class="piece-explanation">
          <h4>üëë Ïû•Íµ∞ (General)</h4>
          <div class="piece-diagram">
            <svg viewBox="0 0 6 6" class="mini-board">
              <rect fill="#f0d9b5" x="0" y="0" width="1" height="1"/><rect fill="#b58863" x="1" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="0" width="1" height="1"/><rect fill="#b58863" x="3" y="0" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="0" width="1" height="1"/><rect fill="#b58863" x="5" y="0" width="1" height="1"/><rect fill="#b58863" x="0" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="1" width="1" height="1"/><rect fill="#b58863" x="2" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="1" width="1" height="1"/><rect fill="#b58863" x="4" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="1" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="2" width="1" height="1"/><rect fill="#b58863" x="1" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="2" width="1" height="1"/><rect fill="#b58863" x="3" y="2" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="2" width="1" height="1"/><rect fill="#b58863" x="5" y="2" width="1" height="1"/><rect fill="#b58863" x="0" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="3" width="1" height="1"/><rect fill="#b58863" x="2" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="3" width="1" height="1"/><rect fill="#b58863" x="4" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="3" width="1" height="1"/><rect fill="#f0d9b5" x="0" y="4" width="1" height="1"/><rect fill="#b58863" x="1" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="2" y="4" width="1" height="1"/><rect fill="#b58863" x="3" y="4" width="1" height="1"/><rect fill="#f0d9b5" x="4" y="4" width="1" height="1"/><rect fill="#b58863" x="5" y="4" width="1" height="1"/><rect fill="#b58863" x="0" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="1" y="5" width="1" height="1"/><rect fill="#b58863" x="2" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="3" y="5" width="1" height="1"/><rect fill="#b58863" x="4" y="5" width="1" height="1"/><rect fill="#f0d9b5" x="5" y="5" width="1" height="1"/>
              <circle cx="2.5" cy="2.5" r="0.3" fill="#333" opacity="0.8"/>
              <circle cx="2.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="1.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="2.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="2.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="1.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
              <circle cx="3.5" cy="3.5" r="0.15" fill="purple" opacity="0.7"/>
            </svg>
          </div>
        </div>
      </div>

      <div id="special-tab" class="tab-content">
        <h3>Î∂àÍ∞ÄÎä•Ìïú ÌäπÏàò Í∑úÏπô</h3>
        <ul>
          <li><strong>Ìè∞ Ï≤´ Ïàò 2Ïπ∏ Ï†ÑÏßÑ:</strong> Î∂àÍ∞ÄÎä•. Ìè∞ÏùÄ Ìï≠ÏÉÅ 1Ïπ∏Îßå Ïù¥Îèô Í∞ÄÎä•</li>
          <li><strong>ÏïôÌååÏÉÅ (En Passant):</strong> Î∂àÍ∞ÄÎä•</li>
          <li><strong>Ï∫êÏä¨ÎßÅ (Castling):</strong> Î∂àÍ∞ÄÎä•</li>
        </ul>

        <h3>Í∏∞ÌÉÄ Í∑úÏπô</h3>
        <ul>
          <li>Ìè∞ ÏäπÍ∏âÏùÄ ÏûêÎèôÏúºÎ°ú Ïù¥Î£®Ïñ¥ÏßÄÎ©∞, ÏÑ†ÌÉùÌï† Ïàò ÏóÜÏäµÎãàÎã§</li>
          <li>ÏäπÍ∏â Í∏∞Î¨ºÏùÄ Ìï≠ÏÉÅ Ïû•Íµ∞(General)ÏûÖÎãàÎã§</li>
          <li>ÍµêÏ∞© ÏÉÅÌÉú(Stalemate)Îäî Ìå®Î∞∞Î°ú Ï≤òÎ¶¨Îê©ÎãàÎã§</li>
          <li><strong>3Ìöå ÎèôÌòï Î∞òÎ≥µ:</strong> Í∞ôÏùÄ Ìè¨ÏßÄÏÖòÏù¥ 3Î≤à Î∞òÎ≥µÎêòÎ©¥ Î¨¥ÏäπÎ∂Ä</li>
          <li><strong>ÌÇπÎßå ÎÇ®ÏùÄ Í≤ΩÏö∞:</strong> ÌÇπ Ïô∏Ïóê Í∏∞Î¨ºÏù¥ ÏóÜÏúºÎ©¥ Ï¶âÏãú Ìå®Î∞∞</li>
        </ul>
      </div>
    </div>
  </div>

  <script src="stockfish.js"></script>
  <script src="bundle.js"></script>
  <script>
    function toggleDarkMode() {
      document.body.classList.toggle('dark');
      const btn = document.querySelector('.theme-toggle');
      btn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    }

    function openRulesModal() {
      document.getElementById('rulesModal').style.display = 'block';
    }

    function closeRulesModal() {
      document.getElementById('rulesModal').style.display = 'none';
    }

    function switchTab(tabName) {
      // Hide all tabs
      const tabs = document.querySelectorAll('.tab-content');
      tabs.forEach(tab => tab.classList.remove('active'));

      // Remove active from all buttons
      const buttons = document.querySelectorAll('.tab-button');
      buttons.forEach(btn => btn.classList.remove('active'));

      // Show selected tab
      document.getElementById(tabName + '-tab').classList.add('active');

      // Highlight active button
      event.target.classList.add('active');
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('rulesModal');
      if (event.target === modal) {
        closeRulesModal();
      }
    }
  </script>
</body>
</html>
